"""
–ó–∞–≤–¥–∞–Ω–Ω—è 4. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫—É–ø–∏ (–ø—ñ—Ä–∞–º—ñ–¥–∏)

–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–¥ –≤–∏–∫–æ–Ω—É—î –ø–æ–±—É–¥–æ–≤—É –±—ñ–Ω–∞—Ä–Ω–∏—Ö –¥–µ—Ä–µ–≤. –í–∏–∫–æ–Ω–∞–Ω–æ –∞–Ω–∞–ª—ñ–∑ –∫–æ–¥—É —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ
—Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫—É–ø–∏.

üëâ –°—É—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è: —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–µ—Ä–µ–≤–∞ —ñ–∑ –º–∞—Å–∏–≤—É –∫—É–ø–∏

–ê–ù–ê–õ–Ü–ó –ë–ê–ó–û–í–û–ì–û –ö–û–î–£:
1. Node - –∫–ª–∞—Å –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—É–∑–ª—ñ–≤ –¥–µ—Ä–µ–≤–∞ –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º id
2. add_edges - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–æ–¥–∞—î –≤—É–∑–ª–∏ —Ç–∞ —Ä–µ–±—Ä–∞ –¥–æ –≥—Ä–∞—Ñ–∞, –ø–æ–∑–∏—Ü—ñ–æ–Ω—É—é—á–∏ —ó—Ö
3. draw_tree - –≤—ñ–∑—É–∞–ª—ñ–∑—É—î –¥–µ—Ä–µ–≤–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é NetworkX —Ç–∞ Matplotlib

–ù–û–í–ï –†–Ü–®–ï–ù–ù–Ø:
1. heap_to_tree - –∫–æ–Ω–≤–µ—Ä—Ç—É—î –º–∞—Å–∏–≤ –∫—É–ø–∏ –≤ –¥–µ—Ä–µ–≤–æ –∑–∞ —Ñ–æ—Ä–º—É–ª–∞–º–∏:
   - –õ—ñ–≤–∏–π –Ω–∞—â–∞–¥–æ–∫ –µ–ª–µ–º–µ–Ω—Ç–∞ i: 2*i + 1
   - –ü—Ä–∞–≤–∏–π –Ω–∞—â–∞–¥–æ–∫ –µ–ª–µ–º–µ–Ω—Ç–∞ i: 2*i + 2
2. visualize_heap - –≤—ñ–∑—É–∞–ª—ñ–∑—É—î –∫—É–ø—É –∑ –º–∞—Å–∏–≤—É
"""

import uuid

import networkx as nx
import matplotlib.pyplot as plt


class Node:
    def __init__(self, key, color="skyblue"):
        self.left = None
        self.right = None
        self.val = key
        self.color = color  # –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—É –≤—É–∑–ª–∞
        self.id = str(uuid.uuid4())  # –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤—É–∑–ª–∞


def add_edges(graph, node, pos, x=0, y=0, layer=1):
    if node is not None:
        graph.add_node(
            node.id, color=node.color, label=node.val
        )  # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è id —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –≤—É–∑–ª–∞
        if node.left:
            graph.add_edge(node.id, node.left.id)
            l = x - 1 / 2**layer
            pos[node.left.id] = (l, y - 1)
            l = add_edges(graph, node.left, pos, x=l, y=y - 1, layer=layer + 1)
    if node.right:
        graph.add_edge(node.id, node.right.id)
        r = x + 1 / 2**layer
        pos[node.right.id] = (r, y - 1)
        r = add_edges(graph, node.right, pos, x=r, y=y - 1, layer=layer + 1)
    return graph


def draw_tree(tree_root):
    tree = nx.DiGraph()
    pos = {tree_root.id: (0, 0)}
    tree = add_edges(tree, tree_root, pos)

    colors = [node[1]["color"] for node in tree.nodes(data=True)]
    labels = {
        node[0]: node[1]["label"] for node in tree.nodes(data=True)
    }  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—É–∑–ª–∞ –¥–ª—è –º—ñ—Ç–æ–∫

    plt.figure(figsize=(8, 5))
    nx.draw(
        tree, pos=pos, labels=labels, arrows=False, node_size=2500, node_color=colors
    )
    plt.show()


# =============================================================================
# –§–£–ù–ö–¶–Ü–á –î–õ–Ø –í–Ü–ó–£–ê–õ–Ü–ó–ê–¶–Ü–á –ë–Ü–ù–ê–†–ù–û–á –ö–£–ü–ò
# =============================================================================


def heap_to_tree(heap_array, index=0):
    """
    –ö–æ–Ω–≤–µ—Ä—Ç—É—î –º–∞—Å–∏–≤ –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫—É–ø–∏ –≤ –¥–µ—Ä–µ–≤–æ –∑ –≤—É–∑–ª—ñ–≤ Node.

    –£ –±—ñ–Ω–∞—Ä–Ω—ñ–π –∫—É–ø—ñ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ñ–π —è–∫ –º–∞—Å–∏–≤:
    - –î–ª—è –µ–ª–µ–º–µ–Ω—Ç–∞ –∑ —ñ–Ω–¥–µ–∫—Å–æ–º i:
      - –õ—ñ–≤–∏–π –¥–æ—á—ñ—Ä–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —ñ–Ω–¥–µ–∫—Å—ñ 2*i + 1
      - –ü—Ä–∞–≤–∏–π –¥–æ—á—ñ—Ä–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —ñ–Ω–¥–µ–∫—Å—ñ 2*i + 2
      - –ë–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –µ–ª–µ–º–µ–Ω—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —ñ–Ω–¥–µ–∫—Å—ñ (i-1) // 2

    Args:
        heap_array: –ú–∞—Å–∏–≤, —â–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –±—ñ–Ω–∞—Ä–Ω—É –∫—É–ø—É
        index: –ü–æ—Ç–æ—á–Ω–∏–π —ñ–Ω–¥–µ–∫—Å —É –º–∞—Å–∏–≤—ñ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 0 - –∫–æ—Ä—ñ–Ω—å)

    Returns:
        Node: –ö–æ—Ä—ñ–Ω—å –¥–µ—Ä–µ–≤–∞ –∞–±–æ None, —è–∫—â–æ —ñ–Ω–¥–µ–∫—Å –≤–∏—Ö–æ–¥–∏—Ç—å –∑–∞ –º–µ–∂—ñ –º–∞—Å–∏–≤—É
    """
    # –ë–∞–∑–æ–≤–∏–π –≤–∏–ø–∞–¥–æ–∫: —ñ–Ω–¥–µ–∫—Å –≤–∏—Ö–æ–¥–∏—Ç—å –∑–∞ –º–µ–∂—ñ –º–∞—Å–∏–≤—É
    if index >= len(heap_array):
        return None

    # –°—Ç–≤–æ—Ä—é—î–º–æ –≤—É–∑–æ–ª –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞
    node = Node(heap_array[index])

    # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å—Ç–≤–æ—Ä—é—î–º–æ –ª—ñ–≤–µ –ø—ñ–¥–¥–µ—Ä–µ–≤–æ
    left_child_index = 2 * index + 1
    node.left = heap_to_tree(heap_array, left_child_index)

    # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–∞–≤–µ –ø—ñ–¥–¥–µ—Ä–µ–≤–æ
    right_child_index = 2 * index + 2
    node.right = heap_to_tree(heap_array, right_child_index)

    return node


def visualize_heap(heap_array):
    """
    –í—ñ–∑—É–∞–ª—ñ–∑—É—î –±—ñ–Ω–∞—Ä–Ω—É –∫—É–ø—É, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—É —è–∫ –º–∞—Å–∏–≤.

    Args:
        heap_array: –ú–∞—Å–∏–≤, —â–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –±—ñ–Ω–∞—Ä–Ω—É –∫—É–ø—É
    """
    if not heap_array:
        print("–ö—É–ø–∞ –ø–æ—Ä–æ–∂–Ω—è!")
        return

    # –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –º–∞—Å–∏–≤ –∫—É–ø–∏ –≤ –¥–µ—Ä–µ–≤–æ
    tree_root = heap_to_tree(heap_array)

    # –í—ñ–∑—É–∞–ª—ñ–∑—É—î–º–æ –¥–µ—Ä–µ–≤–æ
    draw_tree(tree_root)


# =============================================================================
# –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–Ø –†–û–ë–û–¢–ò
# =============================================================================

print("=" * 70)
print("–ü–†–ò–ö–õ–ê–î 1: –ë–∞–∑–æ–≤–µ –¥–µ—Ä–µ–≤–æ (—Ä—É—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è)")
print("=" * 70)

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–µ—Ä–µ–≤–∞ (–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥)
root = Node(0)
root.left = Node(4)
root.left.left = Node(5)
root.left.right = Node(10)
root.right = Node(1)
root.right.left = Node(3)

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–µ—Ä–µ–≤–∞
draw_tree(root)

print("\n" + "=" * 70)
print("–ü–†–ò–ö–õ–ê–î 2: –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –∫—É–ø–∏ –∑ –º–∞—Å–∏–≤—É")
print("=" * 70)
print("–ú–∞—Å–∏–≤ –∫—É–ø–∏: [0, 4, 1, 5, 10, 3]")
print("–°—Ç—Ä—É–∫—Ç—É—Ä–∞:")
print("       0")
print("      / \\")
print("     4   1")
print("    / \\ /")
print("   5  10 3")

# –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç—ñ—î—ó –∂ —Å–∞–º–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏, –∞–ª–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ—ó –∑ –∫—É–ø–∏
heap_array = [0, 4, 1, 5, 10, 3]
visualize_heap(heap_array)

print("\n" + "=" * 70)
print("–ü–†–ò–ö–õ–ê–î 3: Max-Heap (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—É–ø–∞)")
print("=" * 70)
max_heap = [50, 30, 40, 10, 20, 15, 35]
print(f"–ú–∞—Å–∏–≤ –∫—É–ø–∏: {max_heap}")
print("–í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å max-heap: –∫–æ–∂–µ–Ω –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –µ–ª–µ–º–µ–Ω—Ç >= –¥–æ—á—ñ—Ä–Ω—ñ—Ö")
visualize_heap(max_heap)

print("\n" + "=" * 70)
print("–ü–†–ò–ö–õ–ê–î 4: Min-Heap (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫—É–ø–∞)")
print("=" * 70)
min_heap = [5, 10, 15, 20, 30, 25, 40]
print(f"–ú–∞—Å–∏–≤ –∫—É–ø–∏: {min_heap}")
print("–í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å min-heap: –∫–æ–∂–µ–Ω –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –µ–ª–µ–º–µ–Ω—Ç <= –¥–æ—á—ñ—Ä–Ω—ñ—Ö")
visualize_heap(min_heap)
